<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="edp.davinci.dao.DashboardMapper">

    <insert id="insert" parameterType="edp.davinci.model.Dashboard">
        <selectKey resultType="java.lang.Long" order="AFTER" keyProperty="id">
            SELECT LAST_INSERT_ID() AS id
        </selectKey>
        insert into dashboard
        <trim prefix="(" suffix=")" suffixOverrides=",">
            `name`,
            dashboard_portal_id,
            `type`,
            `index`,
            parent_id,
            `config`
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            #{name,jdbcType=VARCHAR},
            #{dashboardPortalId,jdbcType=BIGINT},
            #{type,jdbcType=SMALLINT},
            #{index,jdbcType=INTEGER},
            #{parentId,jdbcType=BIGINT},
            #{config,jdbcType=LONGVARCHAR}
        </trim>
    </insert>


    <update id="updateBatch" parameterType="java.util.List">

        <foreach collection="list" item="item" index="index" open="" close="" separator=";">
            update dashboard
            <set>
                `name` = #{item.name,jdbcType=VARCHAR},
                dashboard_portal_id = #{item.dashboardPortalId,jdbcType=BIGINT},
                `type` = #{item.type,jdbcType=SMALLINT},
                `index` = #{item.index,jdbcType=INTEGER},
                parent_id = #{item.parentId,jdbcType=BIGINT},
                config = #{item.config,jdbcType=LONGVARCHAR}
            </set>
            <where>
                id=#{item.id,jdbcType=BIGINT}
            </where>
        </foreach>
    </update>
</mapper>